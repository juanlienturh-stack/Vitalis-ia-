<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Vitalis AI - Health & Fitness</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-card: #242424;
            --accent-primary: #00d4ff;
            --accent-secondary: #7c3aed;
            --accent-success: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --text-primary: #ffffff;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --border: #333333;
            --gradient-1: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
            --gradient-2: linear-gradient(135deg, #10b981 0%, #00d4ff 100%);
            --shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            padding-bottom: 80px;
        }

        /* Splash Screen */
        #splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s;
        }

        .splash-logo {
            width: 120px;
            height: 120px;
            background: var(--gradient-1);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            animation: pulse 2s infinite;
            box-shadow: 0 0 60px rgba(0,212,255,0.5);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .splash-text {
            margin-top: 20px;
            font-size: 28px;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .splash-subtitle {
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Header */
        .header {
            position: sticky;
            top: 0;
            background: rgba(10,10,10,0.95);
            backdrop-filter: blur(20px);
            padding: 20px;
            z-index: 100;
            border-bottom: 1px solid var(--border);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .icon-btn:hover {
            background: var(--accent-primary);
            color: var(--bg-primary);
        }

        /* Main Content */
        .container {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-1);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: rgba(0,212,255,0.1);
            color: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin-bottom: 12px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-change {
            font-size: 11px;
            margin-top: 8px;
            padding: 4px 8px;
            border-radius: 20px;
            display: inline-block;
        }

        .stat-change.positive {
            background: rgba(16,185,129,0.2);
            color: var(--accent-success);
        }

        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0 15px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
        }

        .see-all {
            color: var(--accent-primary);
            font-size: 14px;
            text-decoration: none;
        }

        /* Feature Cards */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .feature-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .feature-card:active {
            transform: scale(0.98);
        }

        .feature-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(0,212,255,0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .feature-card:hover::after {
            opacity: 1;
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .feature-card.scan .feature-icon { background: rgba(0,212,255,0.1); color: var(--accent-primary); }
        .feature-card.nutrition .feature-icon { background: rgba(16,185,129,0.1); color: var(--accent-success); }
        .feature-card.workout .feature-icon { background: rgba(124,58,237,0.1); color: var(--accent-secondary); }
        .feature-card.steps .feature-icon { background: rgba(245,158,11,0.1); color: var(--accent-warning); }
        .feature-card.style .feature-icon { background: rgba(239,68,68,0.1); color: var(--accent-danger); }
        .feature-card.history .feature-icon { background: rgba(161,161,170,0.1); color: var(--text-secondary); }

        .feature-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .feature-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(26,26,26,0.98);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 1000;
        }

        .nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 11px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .nav-item.active {
            color: var(--accent-primary);
        }

        .nav-item i {
            font-size: 22px;
            margin-bottom: 4px;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal.active {
            display: block;
        }

        .modal-content {
            min-height: 100vh;
            background: var(--bg-primary);
        }

        .modal-header {
            position: sticky;
            top: 0;
            background: var(--bg-primary);
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 100;
        }

        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        /* Camera Interface */
        .camera-container {
            position: relative;
            width: 100%;
            height: 70vh;
            background: #000;
            overflow: hidden;
        }

        #camera-feed, #camera-canvas {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.5) 0%, transparent 30%, transparent 70%, rgba(0,0,0,0.5) 100%);
        }

        .scan-frame {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 280px;
            height: 380px;
            border: 2px solid var(--accent-primary);
            border-radius: 20px;
            box-shadow: 0 0 0 9999px rgba(0,0,0,0.5);
        }

        .scan-frame::before, .scan-frame::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid var(--accent-primary);
        }

        .scan-frame::before {
            top: -3px;
            left: -3px;
            border-right: 0;
            border-bottom: 0;
            border-radius: 20px 0 0 0;
        }

        .scan-frame::after {
            bottom: -3px;
            right: -3px;
            border-left: 0;
            border-top: 0;
            border-radius: 0 0 20px 0;
        }

        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-primary);
            box-shadow: 0 0 10px var(--accent-primary);
            animation: scan 2s linear infinite;
        }

        @keyframes scan {
            0% { top: 0; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        .camera-controls {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 20px;
            background: var(--bg-primary);
        }

        .capture-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--gradient-1);
            border: 4px solid var(--bg-card);
            cursor: pointer;
            position: relative;
            transition: transform 0.2s;
        }

        .capture-btn:active {
            transform: scale(0.9);
        }

        .capture-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 54px;
            height: 54px;
            border-radius: 50%;
            background: #fff;
        }

        /* Progress Bars */
        .progress-container {
            margin: 15px 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .progress-bar {
            height: 8px;
            background: var(--bg-card);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-fill.calories { background: var(--gradient-2); }
        .progress-fill.protein { background: linear-gradient(90deg, #f59e0b, #ef4444); }
        .progress-fill.carbs { background: linear-gradient(90deg, #10b981, #00d4ff); }
        .progress-fill.fat { background: linear-gradient(90deg, #7c3aed, #ec4899); }

        /* Meal Cards */
        .meal-section {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border);
        }

        .meal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .meal-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .add-food-btn {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: var(--accent-primary);
            border: none;
            color: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
        }

        .food-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: var(--bg-primary);
            border-radius: 12px;
            margin-bottom: 8px;
        }

        .food-info h4 {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .food-info p {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .food-calories {
            font-weight: 600;
            color: var(--accent-primary);
        }

        /* Exercise Cards */
        .exercise-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border);
            display: flex;
            gap: 15px;
        }

        .exercise-image {
            width: 80px;
            height: 80px;
            border-radius: 15px;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            flex-shrink: 0;
        }

        .exercise-details {
            flex: 1;
        }

        .exercise-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .exercise-focus {
            font-size: 12px;
            color: var(--accent-primary);
            margin-bottom: 10px;
        }

        .exercise-stats {
            display: flex;
            gap: 15px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .exercise-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Timer */
        .timer-display {
            font-size: 48px;
            font-weight: 700;
            text-align: center;
            font-variant-numeric: tabular-nums;
            margin: 30px 0;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 20px rgba(0,212,255,0.5);
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .timer-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .timer-btn.start {
            background: var(--accent-success);
            color: white;
        }

        .timer-btn.pause {
            background: var(--accent-warning);
            color: white;
        }

        .timer-btn.reset {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        /* Voice Coach Indicator */
        .voice-indicator {
            position: fixed;
            top: 100px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 500;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s;
        }

        .voice-indicator.active {
            opacity: 1;
            transform: scale(1);
            animation: pulse-voice 1.5s infinite;
        }

        @keyframes pulse-voice {
            0%, 100% { box-shadow: 0 0 0 0 rgba(124,58,237,0.7); }
            50% { box-shadow: 0 0 0 20px rgba(124,58,237,0); }
        }

        /* AR Hairstyle Preview */
        .ar-container {
            position: relative;
            width: 100%;
            height: 60vh;
            background: #000;
            overflow: hidden;
        }

        .hairstyle-selector {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 15px;
            background: var(--bg-primary);
            -webkit-overflow-scrolling: touch;
        }

        .hairstyle-thumb {
            min-width: 80px;
            height: 80px;
            border-radius: 15px;
            background: var(--bg-card);
            border: 2px solid transparent;
            cursor: pointer;
            overflow: hidden;
            position: relative;
        }

        .hairstyle-thumb.active {
            border-color: var(--accent-primary);
        }

        .hairstyle-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Charts */
        .chart-container {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            height: 250px;
            position: relative;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 5px 0;
            margin-bottom: 20px;
        }

        .quick-action {
            min-width: 100px;
            padding: 12px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 25px;
            color: var(--text-primary);
            font-size: 13px;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-action:hover {
            background: var(--accent-primary);
            color: var(--bg-primary);
            border-color: var(--accent-primary);
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: var(--bg-card);
            padding: 15px 25px;
            border-radius: 50px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 3000;
            opacity: 0;
            transition: all 0.3s;
        }

        .notification.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .notification.success { border-color: var(--accent-success); }
        .notification.error { border-color: var(--accent-danger); }

        /* Loading States */
        .skeleton {
            background: linear-gradient(90deg, var(--bg-card) 25%, #333 50%, var(--bg-card) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Responsive */
        @media (max-width: 380px) {
            .dashboard-grid, .feature-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Hide scrollbar */
        ::-webkit-scrollbar {
            width: 0;
            height: 0;
        }

        /* Toggle Switch */
        .toggle {
            width: 50px;
            height: 28px;
            background: var(--bg-card);
            border-radius: 14px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
            border: 1px solid var(--border);
        }

        .toggle.active {
            background: var(--accent-primary);
        }

        .toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }

        .toggle.active::after {
            transform: translateX(22px);
        }

        /* Input Fields */
        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .input-field {
            width: 100%;
            padding: 15px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        /* Buttons */
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--gradient-1);
            color: white;
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-success {
            background: var(--accent-success);
            color: white;
        }

        /* 3D Body Model Placeholder */
        .body-model {
            width: 100%;
            height: 400px;
            background: var(--bg-card);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .body-heatmap {
            position: absolute;
            width: 200px;
            height: 350px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 350"><ellipse cx="100" cy="40" rx="30" ry="35" fill="%23ff4444" opacity="0.6"/><rect x="70" y="75" width="60" height="80" rx="10" fill="%23ff8844" opacity="0.6"/><rect x="75" y="155" width="50" height="90" rx="5" fill="%23ffaa44" opacity="0.6"/><rect x="80" y="245" width="40" height="100" rx="5" fill="%2344ff88" opacity="0.6"/></svg>') no-repeat center;
            background-size: contain;
        }

        /* Muscle Map Legend */
        .muscle-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        /* Symmetry Score */
        .symmetry-score {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(var(--accent-primary) 0deg 288deg, var(--bg-card) 288deg 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
        }

        .symmetry-score::before {
            content: '';
            position: absolute;
            width: 130px;
            height: 130px;
            background: var(--bg-card);
            border-radius: 50%;
        }

        .score-value {
            position: relative;
            font-size: 36px;
            font-weight: 700;
            z-index: 1;
        }

        /* Widget Preview */
        .widget-preview {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .widget-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: var(--gradient-1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .widget-info h4 {
            font-size: 14px;
            margin-bottom: 2px;
        }

        .widget-info p {
            font-size: 12px;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>

    <!-- Splash Screen -->
    <div id="splash">
        <div class="splash-logo">
            <i class="fas fa-heartbeat"></i>
        </div>
        <div class="splash-text">Vitalis AI</div>
        <div class="splash-subtitle">Tu asistente de salud inteligente</div>
    </div>

    <!-- Notification Container -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">Operaci√≥n exitosa</span>
    </div>

    <!-- Voice Coach Indicator -->
    <div id="voice-indicator" class="voice-indicator">
        <i class="fas fa-microphone"></i>
    </div>

    <!-- Main App -->
    <div id="app" style="display: none;">
        
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Bienvenido de vuelta</div>
                    <div class="header-title">Vitalis AI</div>
                </div>
                <div class="header-actions">
                    <button class="icon-btn" onclick="showNotification('Modo oscuro activado')">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="icon-btn" onclick="openProfile()">
                        <i class="fas fa-user"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="container">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="quick-action" onclick="quickLogWeight()">
                    <i class="fas fa-weight"></i> Registrar peso
                </button>
                <button class="quick-action" onclick="quickAddWater()">
                    <i class="fas fa-tint"></i> +250ml agua
                </button>
                <button class="quick-action" onclick="quickStartWorkout()">
                    <i class="fas fa-dumbbell"></i> Entrenar
                </button>
                <button class="quick-action" onclick="quickScanFood()">
                    <i class="fas fa-camera"></i> Escanear comida
                </button>
            </div>

            <!-- Dashboard Stats -->
            <div class="dashboard-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-fire"></i></div>
                    <div class="stat-value" id="calories-burned">1,240</div>
                    <div class="stat-label">Calor√≠as hoy</div>
                    <div class="stat-change positive">+12% vs ayer</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(16,185,129,0.1); color: var(--accent-success);">
                        <i class="fas fa-shoe-prints"></i>
                    </div>
                    <div class="stat-value" id="steps-count">8,432</div>
                    <div class="stat-label">Pasos</div>
                    <div class="stat-change positive">Meta: 10k</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(124,58,237,0.1); color: var(--accent-secondary);">
                        <i class="fas fa-dumbbell"></i>
                    </div>
                    <div class="stat-value" id="workout-streak">12</div>
                    <div class="stat-label">D√≠as racha</div>
                    <div class="stat-change positive">¬°Sigue as√≠!</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(245,158,11,0.1); color: var(--accent-warning);">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <div class="stat-value" id="calories-consumed">1,850</div>
                    <div class="stat-label">Kcal consumidas</div>
                    <div class="stat-change positive">350 restantes</div>
                </div>
            </div>

            <!-- Main Features -->
            <div class="section-header">
                <div class="section-title">Funciones Principales</div>
            </div>

            <div class="feature-grid">
                <div class="feature-card scan" onclick="openBodyScan()">
                    <div class="feature-icon"><i class="fas fa-body"></i></div>
                    <div class="feature-title">Escaneo Corporal</div>
                    <div class="feature-desc">An√°lisis 3D con IA de composici√≥n corporal</div>
                </div>
                
                <div class="feature-card scan" onclick="openFaceScan()">
                    <div class="feature-icon"><i class="fas fa-face-viewfinder"></i></div>
                    <div class="feature-title">Escaneo Facial</div>
                    <div class="feature-desc">An√°lisis de simetr√≠a y skincare personalizado</div>
                </div>

                <div class="feature-card nutrition" onclick="openNutrition()">
                    <div class="feature-icon"><i class="fas fa-carrot"></i></div>
                    <div class="feature-title">Nutrici√≥n</div>
                    <div class="feature-desc">Contador de calor√≠as con escaneo de alimentos</div>
                </div>

                <div class="feature-card workout" onclick="openWorkout()">
                    <div class="feature-icon"><i class="fas fa-dumbbell"></i></div>
                    <div class="feature-title">Entrenamiento</div>
                    <div class="feature-desc">Rutinas personalizadas con IA + 200+ ejercicios</div>
                </div>

                <div class="feature-card steps" onclick="openSteps()">
                    <div class="feature-icon"><i class="fas fa-person-walking"></i></div>
                    <div class="feature-title">Actividad</div>
                    <div class="feature-desc">Contador de pasos y tracker GPS</div>
                </div>

                <div class="feature-card style" onclick="openStyle()">
                    <div class="feature-icon"><i class="fas fa-scissors"></i></div>
                    <div class="feature-title">Estilo</div>
                    <div class="feature-desc">Prueba cortes de pelo con AR</div>
                </div>

                <div class="feature-card history" onclick="openHistory()">
                    <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="feature-title">Historial</div>
                    <div class="feature-desc">Progreso unificado y an√°lisis de datos</div>
                </div>

                <div class="feature-card" style="background: linear-gradient(135deg, rgba(0,212,255,0.1), rgba(124,58,237,0.1));" onclick="openAIChat()">
                    <div class="feature-icon" style="background: var(--gradient-1); color: white;">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="feature-title">Asistente IA</div>
                    <div class="feature-desc">Chat inteligente para todas tus dudas</div>
                </div>
            </div>

            <!-- Today's Workout Preview -->
            <div class="section-header">
                <div class="section-title">Entrenamiento de Hoy</div>
                <a href="#" class="see-all" onclick="openWorkout()">Ver todo</a>
            </div>

            <div id="today-workout">
                <div class="exercise-card" onclick="startExercise(0)">
                    <div class="exercise-image">üèãÔ∏è</div>
                    <div class="exercise-details">
                        <div class="exercise-name">Press de Banca</div>
                        <div class="exercise-focus">Pectoral Mayor</div>
                        <div class="exercise-stats">
                            <span class="exercise-stat"><i class="fas fa-redo"></i> 4 series</span>
                            <span class="exercise-stat"><i class="fas fa-dumbbell"></i> 80kg</span>
                            <span class="exercise-stat"><i class="fas fa-clock"></i> 90s desc</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Nutrition Preview -->
            <div class="section-header">
                <div class="section-title">Resumen Nutricional</div>
                <a href="#" class="see-all" onclick="openNutrition()">Detalles</a>
            </div>

            <div class="meal-section">
                <div class="progress-container">
                    <div class="progress-header">
                        <span>Calor√≠as</span>
                        <span id="calories-text">1,850 / 2,200 kcal</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill calories" style="width: 84%"></div>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px;">
                    <div class="progress-container">
                        <div class="progress-header" style="font-size: 12px;">
                            <span>Prote√≠nas</span>
                            <span>140g</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill protein" style="width: 70%"></div>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-header" style="font-size: 12px;">
                            <span>Carbs</span>
                            <span>180g</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill carbs" style="width: 60%"></div>
                        </div>
                    </div>
                    <div class="progress-container">
                        <div class="progress-header" style="font-size: 12px;">
                            <span>Grasas</span>
                            <span>55g</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill fat" style="width: 50%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Widgets Preview -->
            <div class="section-header">
                <div class="section-title">Widgets Disponibles</div>
            </div>

            <div class="widget-preview">
                <div class="widget-icon"><i class="fas fa-stopwatch"></i></div>
                <div class="widget-info">
                    <h4>Temporizador de Descanso</h4>
                    <p>Configura tiempos personalizados por ejercicio</p>
                </div>
                <button class="toggle active" onclick="this.classList.toggle('active')"></button>
            </div>

            <div class="widget-preview">
                <div class="widget-icon" style="background: linear-gradient(135deg, #f59e0b, #ef4444);">
                    <i class="fas fa-droplet"></i>
                </div>
                <div class="widget-info">
                    <h4>Recordatorio de Agua</h4>
                    <p>Notificaciones cada 2 horas</p>
                </div>
                <button class="toggle" onclick="this.classList.toggle('active')"></button>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a class="nav-item active" onclick="showTab('home', this)">
                <i class="fas fa-home"></i>
                <span>Inicio</span>
            </a>
            <a class="nav-item" onclick="showTab('scan', this)">
                <i class="fas fa-camera"></i>
                <span>Escanear</span>
            </a>
            <a class="nav-item" onclick="showTab('workout', this); openWorkout()">
                <i class="fas fa-dumbbell"></i>
                <span>Rutina</span>
            </a>
            <a class="nav-item" onclick="showTab('nutrition', this); openNutrition()">
                <i class="fas fa-utensils"></i>
                <span>Dieta</span>
            </a>
            <a class="nav-item" onclick="showTab('profile', this)">
                <i class="fas fa-user"></i>
                <span>Perfil</span>
            </a>
        </nav>
    </div>

    <!-- MODALS -->

    <!-- Body Scan Modal -->
    <div id="body-scan-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('body-scan-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Escaneo Corporal 3D</h2>
            </div>
            
            <div class="camera-container" id="body-camera">
                <video id="body-video" autoplay playsinline></video>
                <canvas id="body-canvas" style="display: none;"></canvas>
                
                <div class="scan-frame">
                    <div class="scan-line"></div>
                </div>
                
                <div class="camera-overlay">
                    <div style="text-align: center;">
                        <h3 style="margin-bottom: 10px;">Posici√≥n Frontal</h3>
                        <p style="font-size: 14px; opacity: 0.8;">Col√≥cate a 2 metros, ropa interior ajustada</p>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 12px; opacity: 0.7;">
                        <span>1/4</span>
                        <span>Progreso: 25%</span>
                    </div>
                </div>
            </div>

            <div class="camera-controls">
                <button class="icon-btn" onclick="switchCamera()">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="capture-btn" onclick="captureBodyScan()"></button>
                <button class="icon-btn" onclick="toggleFlash()">
                    <i class="fas fa-bolt"></i>
                </button>
            </div>

            <!-- Results Section (Hidden initially) -->
            <div id="body-results" style="display: none; padding: 20px;">
                <div class="body-model">
                    <div class="body-heatmap"></div>
                    <div style="position: absolute; bottom: 20px; background: rgba(0,0,0,0.8); padding: 15px; border-radius: 15px; text-align: center;">
                        <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 5px;">Tu composici√≥n</div>
                        <div style="font-size: 24px; font-weight: 700;">12% Grasa</div>
                    </div>
                </div>

                <div class="muscle-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ff4444;"></div>
                        <span>Alto desarrollo</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ff8844;"></div>
                        <span>Desarrollo medio</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ffaa44;"></div>
                        <span>En progreso</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #44ff88;"></div>
                        <span>Zona a trabajar</span>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <h3 style="margin-bottom: 15px;">M√©tricas Detalladas</h3>
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-value">12.4%</div>
                            <div class="stat-label">Grasa Corporal</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">67.2%</div>
                            <div class="stat-label">Masa Muscular</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">0.82</div>
                            <div class="stat-label">Relaci√≥n Cintura-Cadera</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">78kg</div>
                            <div class="stat-label">Peso Estimado</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container" style="margin-top: 20px;">
                    <h4 style="margin-bottom: 15px;">Evoluci√≥n del Volumen Muscular</h4>
                    <div style="height: 180px; display: flex; align-items: flex-end; justify-content: space-around; padding: 0 10px;">
                        <div style="width: 30px; background: var(--accent-primary); height: 60%; border-radius: 5px 5px 0 0; position: relative;">
                            <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px;">Ene</span>
                        </div>
                        <div style="width: 30px; background: var(--accent-primary); height: 65%; border-radius: 5px 5px 0 0; position: relative;">
                            <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px;">Feb</span>
                        </div>
                        <div style="width: 30px; background: var(--accent-primary); height: 70%; border-radius: 5px 5px 0 0; position: relative;">
                            <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px;">Mar</span>
                        </div>
                        <div style="width: 30px; background: var(--accent-primary); height: 75%; border-radius: 5px 5px 0 0; position: relative;">
                            <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px;">Abr</span>
                        </div>
                        <div style="width: 30px; background: var(--accent-secondary); height: 85%; border-radius: 5px 5px 0 0; position: relative;">
                            <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px;">May</span>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" style="margin-top: 20px;" onclick="saveBodyScan()">
                    <i class="fas fa-save"></i> Guardar Escaneo
                </button>
            </div>
        </div>
    </div>

    <!-- Face Scan Modal -->
    <div id="face-scan-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('face-scan-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>An√°lisis Facial</h2>
            </div>

            <div class="camera-container" style="height: 50vh;">
                <video id="face-video" autoplay playsinline></video>
                <div class="scan-frame" style="width: 240px; height: 300px; border-radius: 50% 50% 45% 45%;">
                    <div class="scan-line"></div>
                </div>
                <div class="camera-overlay">
                    <div style="text-align: center;">
                        <p style="font-size: 14px; opacity: 0.8;">Centra tu rostro en el √≥valo</p>
                    </div>
                </div>
            </div>

            <div class="camera-controls">
                <button class="capture-btn" onclick="captureFaceScan()"></button>
            </div>

            <div id="face-results" style="padding: 20px; display: none;">
                <div class="symmetry-score">
                    <div class="score-value">8.4</div>
                </div>
                <p style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">Puntuaci√≥n de Simetr√≠a / 10</p>

                <div class="meal-section">
                    <h4 style="margin-bottom: 15px;">An√°lisis Detallado</h4>
                    <div class="food-item">
                        <div class="food-info">
                            <h4>Simetr√≠a Facial</h4>
                            <p>94% - Excelente balance</p>
                        </div>
                        <div class="food-calories">9.2</div>
                    </div>
                    <div class="food-item">
                        <div class="food-info">
                            <h4>Proporci√≥n √Åurea</h4>
                            <p>1:1.62 - Cercano al ideal</p>
                        </div>
                        <div class="food-calories">8.5</div>
                    </div>
                    <div class="food-item">
                        <div class="food-info">
                            <h4>Salud de la Piel</h4>
                            <p>Hidratazione media, poros visibles</p>
                        </div>
                        <div class="food-calories">7.8</div>
                    </div>
                    <div class="food-item">
                        <div class="food-info">
                            <h4>Edad Percibida</h4>
                            <p>26 a√±os (real: 28)</p>
                        </div>
                        <div class="food-calories">+2</div>
                    </div>
                </div>

                <div class="meal-section">
                    <h4 style="margin-bottom: 15px;">Rutina de Skincare IA</h4>
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <div style="flex: 1; padding: 15px; background: var(--bg-primary); border-radius: 12px; text-align: center;">
                            <i class="fas fa-sun" style="color: var(--accent-warning); font-size: 24px; margin-bottom: 8px;"></i>
                            <div style="font-size: 12px; font-weight: 600;">Ma√±ana</div>
                            <div style="font-size: 11px; color: var(--text-secondary); margin-top: 5px;">Vit C + SPF 50</div>
                        </div>
                        <div style="flex: 1; padding: 15px; background: var(--bg-primary); border-radius: 12px; text-align: center;">
                            <i class="fas fa-moon" style="color: var(--accent-secondary); font-size: 24px; margin-bottom: 8px;"></i>
                            <div style="font-size: 12px; font-weight: 600;">Noche</div>
                            <div style="font-size: 11px; color: var(--text-secondary); margin-top: 5px;">Retinol + Hidrante</div>
                        </div>
                    </div>
                    <button class="btn btn-secondary" onclick="showNotification('Rutina guardada')">
                        <i class="fas fa-calendar-plus"></i> A√±adir a mi calendario
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Nutrition Modal -->
    <div id="nutrition-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('nutrition-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Nutrici√≥n & Dietas</h2>
                <button class="icon-btn" onclick="openFoodCamera()" style="margin-left: auto;">
                    <i class="fas fa-camera"></i>
                </button>
            </div>

            <div class="container">
                <!-- Daily Summary -->
                <div class="stat-card" style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div>
                            <div style="font-size: 32px; font-weight: 700;">1,850</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">de 2,200 kcal</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 14px; color: var(--accent-success);">350 restantes</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">Meta: P√©rdida de grasa</div>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill calories" style="width: 84%"></div>
                    </div>
                </div>

                <!-- Macros -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px;">
                    <div class="stat-card" style="text-align: center;">
                        <div style="font-size: 20px; font-weight: 700; color: var(--accent-warning);">140g</div>
                        <div style="font-size: 11px; color: var(--text-secondary);">Prote√≠nas</div>
                        <div style="font-size: 10px; color: var(--text-muted);">obj: 180g</div>
                    </div>
                    <div class="stat-card" style="text-align: center;">
                        <div style="font-size: 20px; font-weight: 700; color: var(--accent-primary);">180g</div>
                        <div style="font-size: 11px; color: var(--text-secondary);">Carbs</div>
                        <div style="font-size: 10px; color: var(--text-muted);">obj: 220g</div>
                    </div>
                    <div class="stat-card" style="text-align: center;">
                        <div style="font-size: 20px; font-weight: 700; color: var(--accent-danger);">55g</div>
                        <div style="font-size: 11px; color: var(--text-secondary);">Grasas</div>
                        <div style="font-size: 10px; color: var(--text-muted);">obj: 65g</div>
                    </div>
                </div>

                <!-- Quick Add -->
                <button class="btn btn-primary" style="margin-bottom: 20px;" onclick="openFoodCamera()">
                    <i class="fas fa-camera"></i> Escanear Comida con IA
                </button>

                <!-- Meals -->
                <div class="meal-section">
                    <div class="meal-header">
                        <div class="meal-title">
                            <i class="fas fa-coffee" style="color: var(--accent-warning);"></i>
                            Desayuno
                        </div>
                        <button class="add-food-btn" onclick="addFood('breakfast')">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div id="breakfast-items">
                        <div class="food-item">
                            <div class="food-info">
                                <h4>Avena con prote√≠na</h4>
                                <p>80g avena + 30g whey + pl√°tano</p>
                            </div>
                            <div class="food-calories">450 kcal</div>
                        </div>
                    </div>
                </div>

                <div class="meal-section">
                    <div class="meal-header">
                        <div class="meal-title">
                            <i class="fas fa-utensils" style="color: var(--accent-success);"></i>
                            Almuerzo
                        </div>
                        <button class="add-food-btn" onclick="addFood('lunch')">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div id="lunch-items">
                        <div class="food-item">
                            <div class="food-info">
                                <h4>Pechuga de pollo</h4>
                                <p>200g + arroz 150g + br√≥coli</p>
                            </div>
                            <div class="food-calories">650 kcal</div>
                        </div>
                    </div>
                </div>

                <div class="meal-section">
                    <div class="meal-header">
                        <div class="meal-title">
                            <i class="fas fa-moon" style="color: var(--accent-secondary);"></i>
                            Cena
                        </div>
                        <button class="add-food-btn" onclick="addFood('dinner')">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div id="dinner-items">
                        <div class="food-item">
                            <div class="food-info">
                                <h4>Salm√≥n a la plancha</h4>
                                <p>180g + ensalada mixta + aguacate</p>
                            </div>
                            <div class="food-calories">520 kcal</div>
                        </div>
                    </div>
                </div>

                <div class="meal-section">
                    <div class="meal-header">
                        <div class="meal-title">
                            <i class="fas fa-cookie-bite" style="color: var(--accent-danger);"></i>
                            Snacks
                        </div>
                        <button class="add-food-btn" onclick="addFood('snacks')">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div id="snacks-items">
                        <div class="food-item">
                            <div class="food-info">
                                <h4>Yogur griego + frutos secos</h4>
                                <p>200g yogur + 30g almendras</p>
                            </div>
                            <div class="food-calories">230 kcal</div>
                        </div>
                    </div>
                </div>

                <!-- AI Features -->
                <div class="section-header">
                    <div class="section-title">Funciones IA</div>
                </div>

                <button class="btn btn-secondary" style="margin-bottom: 10px;" onclick="generateRecipe()">
                    <i class="fas fa-robot"></i> Generar Receta con lo que tengo
                </button>
                <button class="btn btn-secondary" style="margin-bottom: 10px;" onclick="emotionalEatingCheck()">
                    <i class="fas fa-brain"></i> Check-in Hambre Emocional
                </button>
                <button class="btn btn-secondary" onclick="generateShoppingList()">
                    <i class="fas fa-shopping-cart"></i> Lista de Compra Inteligente
                </button>
            </div>
        </div>
    </div>

    <!-- Workout Modal -->
    <div id="workout-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('workout-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Entrenamiento</h2>
                <button class="icon-btn" onclick="openAIChat()" style="margin-left: auto;">
                    <i class="fas fa-robot"></i>
                </button>
            </div>

            <div class="container">
                <!-- Today's Session -->
                <div class="stat-card" style="margin-bottom: 20px; background: var(--gradient-1); border: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-size: 12px; opacity: 0.9;">Hoy: Push (Pecho-Hombros-Tr√≠ceps)</div>
                            <div style="font-size: 20px; font-weight: 700; margin-top: 5px;">4 ejercicios pendientes</div>
                        </div>
                        <button class="btn" style="width: auto; padding: 10px 20px; background: white; color: #000;" onclick="startWorkout()">
                            Iniciar
                        </button>
                    </div>
                </div>

                <!-- Exercise Database -->
                <div class="section-header">
                    <div class="section-title">Base de Datos (200+ ejercicios)</div>
                </div>

                <div class="quick-actions">
                    <button class="quick-action active" onclick="filterExercises('chest')">Pecho</button>
                    <button class="quick-action" onclick="filterExercises('back')">Espalda</button>
                    <button class="quick-action" onclick="filterExercises('shoulders')">Hombros</button>
                    <button class="quick-action" onclick="filterExercises('legs')">Piernas</button>
                    <button class="quick-action" onclick="filterExercises('arms')">Brazos</button>
                    <button class="quick-action" onclick="filterExercises('abs')">Abdomen</button>
                </div>

                <div id="exercise-list">
                    <!-- Chest Exercises -->
                    <div class="exercise-card" onclick="showExerciseDetail(0)">
                        <div class="exercise-image">üèãÔ∏è</div>
                        <div class="exercise-details">
                            <div class="exercise-name">Press de Banca con Barra</div>
                            <div class="exercise-focus">Pectoral Mayor (General)</div>
                            <div class="exercise-stats">
                                <span><i class="fas fa-layer-group"></i> Intermedio</span>
                                <span><i class="fas fa-fire"></i> Alto volumen</span>
                            </div>
                        </div>
                    </div>

                    <div class="exercise-card" onclick="showExerciseDetail(1)">
                        <div class="exercise-image">üèãÔ∏è</div>
                        <div class="exercise-details">
                            <div class="exercise-name">Press Inclinado con Mancuernas</div>
                            <div class="exercise-focus">Pectoral Superior</div>
                            <div class="exercise-stats">
                                <span><i class="fas fa-layer-group"></i> Intermedio</span>
                                <span><i class="fas fa-arrows-alt-v"></i> Rango completo</span>
                            </div>
                        </div>
                    </div>

                    <div class="exercise-card" onclick="showExerciseDetail(2)">
                        <div class="exercise-image">üèãÔ∏è</div>
                        <div class="exercise-details">
                            <div class="exercise-name">Aperturas con Mancuernas</div>
                            <div class="exercise-focus">Estiramiento Pectoral</div>
                            <div class="exercise-stats">
                                <span><i class="fas fa-layer-group"></i> Principiante</span>
                                <span><i class="fas fa-heart"></i> Aislamiento</span>
                            </div>
                        </div>
                    </div>

                    <div class="exercise-card" onclick="showExerciseDetail(3)">
                        <div class="exercise-image">üí™</div>
                        <div class="exercise-details">
                            <div class="exercise-name">Fondos en Paralelas</div>
                            <div class="exercise-focus">Pectoral Inferior + Tr√≠ceps</div>
                            <div class="exercise-stats">
                                <span><i class="fas fa-layer-group"></i> Avanzado</span>
                                <span><i class="fas fa-weight-hanging"></i> Peso corporal</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Routine Builder -->
                <div class="section-header" style="margin-top: 30px;">
                    <div class="section-title">Crear Rutina con IA</div>
                </div>

                <div class="meal-section">
                    <div class="input-group">
                        <label class="input-label">¬øCu√°l es tu objetivo?</label>
                        <input type="text" class="input-field" placeholder="Ej: Hipertrofia, p√©rdida de grasa, fuerza..." id="routine-goal">
                    </div>
                    <div class="input-group">
                        <label class="input-label">D√≠as disponibles por semana</label>
                        <input type="number" class="input-field" placeholder="3-6 d√≠as" id="routine-days">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Grupos musculares prioritarios</label>
                        <input type="text" class="input-field" placeholder="Ej: Gl√∫teos, pecho, espalda..." id="routine-focus">
                    </div>
                    <button class="btn btn-primary" onclick="generateRoutineWithAI()">
                        <i class="fas fa-magic"></i> Generar Rutina Personalizada
                    </button>
                </div>

                <!-- Calculators -->
                <div class="section-header">
                    <div class="section-title">Calculadoras</div>
                </div>

                <button class="btn btn-secondary" style="margin-bottom: 10px;" onclick="open1RMCalculator()">
                    <i class="fas fa-calculator"></i> Calculadora 1RM
                </button>
                <button class="btn btn-secondary" onclick="openVolumeCalculator()">
                    <i class="fas fa-chart-bar"></i> Volumen de Entrenamiento
                </button>
            </div>
        </div>
    </div>

    <!-- Active Workout Modal -->
    <div id="active-workout-modal" class="modal">
        <div class="modal-content" style="background: var(--bg-primary);">
            <div class="modal-header" style="background: var(--bg-card);">
                <button class="back-btn" onclick="pauseWorkout()">
                    <i class="fas fa-pause"></i>
                </button>
                <div style="text-align: center;">
                    <div style="font-size: 12px; color: var(--text-secondary);">Ejercicio 1 de 4</div>
                    <div style="font-size: 16px; font-weight: 600;">Press de Banca</div>
                </div>
                <button class="icon-btn" onclick="toggleVoiceCoach()" id="voice-btn">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>

            <div style="padding: 20px; text-align: center;">
                <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 10px;">Serie 2 de 4</div>
                
                <div style="display: flex; justify-content: center; gap: 30px; margin: 30px 0;">
                    <div style="text-align: center;">
                        <div style="font-size: 48px; font-weight: 700; color: var(--accent-primary);" id="weight-display">80</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">kg</div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; justify-content: center;">
                            <button class="icon-btn" onclick="adjustWeight(-2.5)">-</button>
                            <button class="icon-btn" onclick="adjustWeight(2.5)">+</button>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 48px; font-weight: 700; color: var(--accent-success);" id="reps-display">8</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">reps</div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; justify-content: center;">
                            <button class="icon-btn" onclick="adjustReps(-1)">-</button>
                            <button class="icon-btn" onclick="adjustReps(1)">+</button>
                        </div>
                    </div>
                </div>

                <button class="btn btn-success" style="margin-bottom: 20px; height: 60px; font-size: 18px;" onclick="completeSet()">
                    <i class="fas fa-check"></i> Completar Serie
                </button>

                <!-- Rest Timer -->
                <div class="stat-card" style="background: var(--bg-card);">
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 10px;">Descanso</div>
                    <div class="timer-display" id="rest-timer">01:30</div>
                    <div class="timer-controls">
                        <button class="timer-btn start" onclick="startRestTimer()" id="timer-btn">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="timer-btn reset" onclick="resetRestTimer()">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>
                    <div style="margin-top: 15px; font-size: 12px; color: var(--text-secondary);">
                        Descanso personalizado: 90 segundos
                    </div>
                </div>

                <!-- Previous Performance -->
                <div style="margin-top: 20px; text-align: left;">
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 10px;">Rendimiento anterior:</div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <span style="padding: 8px 12px; background: var(--bg-card); border-radius: 20px; font-size: 12px;">Serie 1: 80kg x 10 reps ‚úì</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Steps Modal -->
    <div id="steps-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('steps-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Actividad Diaria</h2>
            </div>

            <div class="container">
                <!-- Main Step Counter -->
                <div class="stat-card" style="text-align: center; padding: 40px 20px; margin-bottom: 20px;">
                    <div style="font-size: 64px; font-weight: 700; margin-bottom: 10px;" id="steps-main">8,432</div>
                    <div style="font-size: 16px; color: var(--text-secondary); margin-bottom: 20px;">pasos hoy</div>
                    
                    <div style="display: flex; justify-content: center; gap: 30px;">
                        <div>
                            <div style="font-size: 20px; font-weight: 600;">6.2</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">km</div>
                        </div>
                        <div>
                            <div style="font-size: 20px; font-weight: 600;">420</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">kcal</div>
                        </div>
                        <div>
                            <div style="font-size: 20px; font-weight: 600;">1h 25m</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">activo</div>
                        </div>
                    </div>
                </div>

                <!-- Progress to Goal -->
                <div class="meal-section">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>Progreso hacia meta</span>
                        <span style="color: var(--accent-primary);">84%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill calories" style="width: 84%"></div>
                    </div>
                    <p style="font-size: 12px; color: var(--text-secondary); margin-top: 10px;">
                        Te faltan 1,568 pasos para llegar a tu meta de 10,000
                    </p>
                </div>

                <!-- Weekly Chart -->
                <div class="chart-container">
                    <h4 style="margin-bottom: 15px;">√öltimos 7 d√≠as</h4>
                    <div style="height: 180px; display: flex; align-items: flex-end; justify-content: space-around; padding: 0 10px;">
                        <div style="text-align: center;">
                            <div style="width: 30px; background: var(--accent-primary); height: 70%; border-radius: 5px 5px 0 0; margin: 0 auto;"></div>
                            <span style="font-size: 10px; color: var(--text-secondary); margin-top: 5px; display: block;">Lun</span>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 30px; background: var(--accent-primary); height: 85%; border-radius: 5px 5px 0 0; margin: 0 auto;"></div>
                            <span style="font-size: 10px; color: var(--text-secondary); margin-top: 5px; display: block;">Mar</span>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 30px; background: var(--accent-primary); height: 60%; border-radius: 5px 5px 0 0; margin: 0 auto;"></div>
                            <span style="font-size: 10px; color: var(--text-secondary); margin-top: 5px; display: block;">Mi√©</span>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 30px; background: var(--accent-primary); height: 90%; border-radius: 5px 5px 0 0; margin: 0 auto;"></div>
                            <span style="font-size: 10px; color: var(--text-secondary); margin-top: 5px; display: block;">Jue</span>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 30px; background: var(--accent-primary); height: 75%; border-radius: 5px 5px 0 0; margin: 0 auto;"></div>
                            <span style="font-size: 10px; color: var(--text-secondary); margin-top: 5px; display: block;">Vie</span>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 30px; background: var(--accent-secondary); height: 95%; border-radius: 5px 5px 0 0; margin: 0 auto;"></div>
                            <span style="font-size: 10px; color: var(--text-secondary); margin-top: 5px; display: block;">S√°b</span>
                        </div>
                        <div style="text-align: center;">
                            <div style="width: 30px; background: var(--accent-primary); height: 84%; border-radius: 5px 5px 0 0; margin: 0 auto;"></div>
                            <span style="font-size: 10px; color: var(--text-secondary); margin-top: 5px; display: block;">Dom</span>
                        </div>
                    </div>
                </div>

                <!-- GPS Activity -->
                <div class="section-header">
                    <div class="section-title">Actividad GPS</div>
                </div>

                <button class="btn btn-primary" onclick="startGPSActivity()">
                    <i class="fas fa-running"></i> Iniciar Carrera/Caminata GPS
                </button>

                <div id="gps-map" style="height: 200px; background: var(--bg-card); border-radius: 15px; margin-top: 15px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                    <i class="fas fa-map-marked-alt" style="font-size: 48px; margin-bottom: 10px; display: block; text-align: center;"></i>
                    <p>Mapa de ruta (requiere GPS)</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Style/Hairstyle Modal -->
    <div id="style-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('style-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Encuentra tu Estilo</h2>
            </div>

            <div class="ar-container">
                <video id="style-video" autoplay playsinline style="width: 100%; height: 100%; object-fit: cover;"></video>
                <div style="position: absolute; top: 20px; left: 20px; right: 20px; background: rgba(0,0,0,0.7); padding: 15px; border-radius: 15px;">
                    <div style="font-size: 14px; font-weight: 600; margin-bottom: 5px;">Corte actual: Undercut Moderno</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">95% de compatibilidad con tu tipo de rostro</div>
                </div>
            </div>

            <div class="hairstyle-selector">
                <div class="hairstyle-thumb active" onclick="selectHairstyle(0)">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #333, #666); display: flex; align-items: center; justify-content: center; font-size: 24px;">
                        üíá
                    </div>
                </div>
                <div class="hairstyle-thumb" onclick="selectHairstyle(1)">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #444, #777); display: flex; align-items: center; justify-content: center; font-size: 24px;">
                        ü¶±
                    </div>
                </div>
                <div class="hairstyle-thumb" onclick="selectHairstyle(2)">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #555, #888); display: flex; align-items: center; justify-content: center; font-size: 24px;">
                        üßë‚Äçü¶±
                    </div>
                </div>
                <div class="hairstyle-thumb" onclick="selectHairstyle(3)">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #666, #999); display: flex; align-items: center; justify-content: center; font-size: 24px;">
                        ü¶≤
                    </div>
                </div>
                <div class="hairstyle-thumb" onclick="selectHairstyle(4)">
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #777, #aaa); display: flex; align-items: center; justify-content: center; font-size: 24px;">
                        üßî
                    </div>
                </div>
            </div>

            <div style="padding: 20px;">
                <h3 style="margin-bottom: 15px;">Recomendaciones para tu Rostro Ovalado</h3>
                
                <div class="exercise-card" style="cursor: pointer;" onclick="showHairstyleDetail(0)">
                    <div class="exercise-image" style="font-size: 30px;">üíá</div>
                    <div class="exercise-details">
                        <div class="exercise-name">Undercut Texturizado</div>
                        <div class="exercise-focus">Ideal para rostro ovalado</div>
                        <div style="margin-top: 8px;">
                            <span style="padding: 4px 10px; background: var(--accent-success); color: white; border-radius: 10px; font-size: 11px;">98% match</span>
                        </div>
                    </div>
                </div>

                <div class="exercise-card" style="cursor: pointer;" onclick="showHairstyleDetail(1)">
                    <div class="exercise-image" style="font-size: 30px;">ü¶±</div>
                    <div class="exercise-details">
                        <div class="exercise-name">Crew Cut Moderno</div>
                        <div class="exercise-focus">Estilo limpio y profesional</div>
                        <div style="margin-top: 8px;">
                            <span style="padding: 4px 10px; background: var(--accent-primary); color: white; border-radius: 10px; font-size: 11px;">94% match</span>
                        </div>
                    </div>
                </div>

                <div class="exercise-card" style="cursor: pointer;" onclick="showHairstyleDetail(2)">
                    <div class="exercise-image" style="font-size: 30px;">üßë‚Äçü¶±</div>
                    <div class="exercise-details">
                        <div class="exercise-name">Side Part Cl√°sico</div>
                        <div class="exercise-focus">Vers√°til y elegante</div>
                        <div style="margin-top: 8px;">
                            <span style="padding: 4px 10px; background: var(--accent-warning); color: white; border-radius: 10px; font-size: 11px;">89% match</span>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" style="margin-top: 20px;">
                    <i class="fas fa-calendar"></i> Agendar con Barbero
                </button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div id="history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('history-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Historial Completo</h2>
                <button class="icon-btn" onclick="exportData()" style="margin-left: auto;">
                    <i class="fas fa-download"></i>
                </button>
            </div>

            <div class="container">
                <!-- Filters -->
                <div class="quick-actions">
                    <button class="quick-action active" onclick="filterHistory('all')">Todo</button>
                    <button class="quick-action" onclick="filterHistory('body')">Escaneos</button>
                    <button class="quick-action" onclick="filterHistory('workout')">Entrenos</button>
                    <button class="quick-action" onclick="filterHistory('nutrition')">Nutrici√≥n</button>
                    <button class="quick-action" onclick="filterHistory('steps')">Pasos</button>
                </div>

                <!-- Timeline -->
                <div style="position: relative; padding-left: 30px;">
                    <div style="position: absolute; left: 8px; top: 0; bottom: 0; width: 2px; background: var(--border);"></div>
                    
                    <div style="margin-bottom: 25px; position: relative;">
                        <div style="position: absolute; left: -26px; width: 16px; height: 16px; background: var(--accent-primary); border-radius: 50%; border: 3px solid var(--bg-primary);"></div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">Hoy, 08:30 AM</div>
                        <div class="meal-section" style="margin: 0;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas fa-dumbbell" style="color: var(--accent-primary); font-size: 20px;"></i>
                                <div>
                                    <div style="font-weight: 600;">Entrenamiento Push</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">4 ejercicios ‚Ä¢ 45 min ‚Ä¢ 320 kcal</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 25px; position: relative;">
                        <div style="position: absolute; left: -26px; width: 16px; height: 16px; background: var(--accent-success); border-radius: 50%; border: 3px solid var(--bg-primary);"></div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">Hoy, 07:00 AM</div>
                        <div class="meal-section" style="margin: 0;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas fa-utensils" style="color: var(--accent-success); font-size: 20px;"></i>
                                <div>
                                    <div style="font-weight: 600;">Desayuno registrado</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Avena con prote√≠na ‚Ä¢ 450 kcal</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 25px; position: relative;">
                        <div style="position: absolute; left: -26px; width: 16px; height: 16px; background: var(--accent-secondary); border-radius: 50%; border: 3px solid var(--bg-primary);"></div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">Ayer, 09:15 PM</div>
                        <div class="meal-section" style="margin: 0;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas fa-body" style="color: var(--accent-secondary); font-size: 20px;"></i>
                                <div>
                                    <div style="font-weight: 600;">Escaneo Corporal #12</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">12.4% grasa ‚Ä¢ +0.5kg m√∫sculo</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 25px; position: relative;">
                        <div style="position: absolute; left: -26px; width: 16px; height: 16px; background: var(--accent-warning); border-radius: 50%; border: 3px solid var(--bg-primary);"></div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">Ayer, 06:30 PM</div>
                        <div class="meal-section" style="margin: 0;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas fa-shoe-prints" style="color: var(--accent-warning); font-size: 20px;"></i>
                                <div>
                                    <div style="font-weight: 600;">10,245 pasos</div>
                                    <div style="font-size: 12px; color: var(--text-secondary);">Meta alcanzada ‚Ä¢ 7.2 km</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Summary -->
                <div class="section-header">
                    <div class="section-title">Resumen del Mes</div>
                </div>

                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-value">18</div>
                        <div class="stat-label">Entrenamientos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">94%</div>
                        <div class="stat-label">Cumplimiento dieta</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">+1.2kg</div>
                        <div class="stat-label">Masa muscular</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">-0.8%</div>
                        <div class="stat-label">Grasa corporal</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chat Modal -->
    <div id="ai-chat-modal" class="modal">
        <div class="modal-content" style="display: flex; flex-direction: column; height: 100vh;">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('ai-chat-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Asistente Vitalis AI</h2>
            </div>

            <div id="chat-messages" style="flex: 1; overflow-y: auto; padding: 20px; background: var(--bg-primary);">
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <div style="width: 35px; height: 35px; border-radius: 50%; background: var(--gradient-1); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <i class="fas fa-robot" style="font-size: 14px;"></i>
                    </div>
                    <div style="background: var(--bg-card); padding: 12px 15px; border-radius: 15px; border-bottom-left-radius: 5px; max-width: 80%;">
                        <div style="font-size: 14px;">¬°Hola! Soy tu asistente de Vitalis AI. Puedo ayudarte con:</div>
                        <ul style="font-size: 13px; margin-top: 8px; margin-left: 15px; color: var(--text-secondary);">
                            <li>Crear rutinas personalizadas</li>
                            <li>Analizar tu progreso</li>
                            <li>Recomendaciones de nutrici√≥n</li>
                            <li>T√©cnica de ejercicios</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div style="padding: 15px; background: var(--bg-card); border-top: 1px solid var(--border);">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="chat-input" class="input-field" placeholder="Escribe tu pregunta..." style="margin: 0;" onkeypress="if(event.key==='Enter') sendMessage()">
                    <button class="btn btn-primary" style="width: auto; padding: 0 20px;" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div style="display: flex; gap: 8px; margin-top: 10px; overflow-x: auto;">
                    <button class="quick-action" style="min-width: auto; padding: 8px 12px; font-size: 12px;" onclick="quickAsk('Crea una rutina de 3 d√≠as')">Rutina 3 d√≠as</button>
                    <button class="quick-action" style="min-width: auto; padding: 8px 12px; font-size: 12px;" onclick="quickAsk('¬øQu√© comer post-entreno?')">Post-entreno</button>
                    <button class="quick-action" style="min-width: auto; padding: 8px 12px; font-size: 12px;" onclick="quickAsk('Analiza mi progreso')">Mi progreso</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Food Camera Modal -->
    <div id="food-camera-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="back-btn" onclick="closeModal('food-camera-modal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2>Escanear Comida</h2>
            </div>

            <div class="camera-container">
                <video id="food-video" autoplay playsinline></video>
                <canvas id="food-canvas" style="display: none;"></canvas>
                
                <div class="camera-overlay">
                    <div style="text-align: center;">
                        <h3>Enfoca tu plato</h3>
                        <p style="font-size: 14px; opacity: 0.8;">La IA identificar√° autom√°ticamente los alimentos</p>
                    </div>
                </div>
            </div>

            <div class="camera-controls">
                <button class="capture-btn" onclick="captureFood()"></button>
            </div>

            <div id="food-analysis" style="padding: 20px; display: none;">
                <div class="meal-section">
                    <h4 style="margin-bottom: 15px;">Alimentos Detectados</h4>
                    <div class="food-item">
                        <div class="food-info">
                            <h4>Pollo a la plancha</h4>
                            <p>~200g estimado</p>
                        </div>
                        <div class="food-calories">330 kcal</div>
                    </div>
                    <div class="food-item">
                        <div class="food-info">
                            <h4>Arroz blanco</h4>
                            <p>~150g estimado</p>
                        </div>
                        <div class="food-calories">195 kcal</div>
                    </div>
                    <div class="food-item">
                        <div class="food-info">
                            <h4>Br√≥coli al vapor</h4>
                            <p>~100g estimado</p>
                        </div>
                        <div class="food-calories">35 kcal</div>
                    </div>
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; font-weight: 600;">
                        <span>Total estimado:</span>
                        <span style="color: var(--accent-primary);">560 kcal</span>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="confirmFoodLog()">
                    <i class="fas fa-check"></i> Confirmar Registro
                </button>
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="retakeFood()">
                    <i class="fas fa-redo"></i> Tomar otra foto
                </button>
            </div>
        </div>
    </div>

    <script>
        // App State
        let currentStream = null;
        let voiceCoachEnabled = false;
        let restTimerInterval = null;
        let restTimeRemaining = 90;
        let currentExercise = null;
        let stepCount = 8432;
        let workoutActive = false;

        // Initialize
        window.onload = function() {
            setTimeout(() => {
                document.getElementById('splash').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('splash').style.display = 'none';
                    document.getElementById('app').style.display = 'block';
                    initStepCounter();
                }, 500);
            }, 2000);

            // Request motion permissions for iOS
            if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
                DeviceMotionEvent.requestPermission();
            }
        };

        // Navigation
        function showTab(tab, element) {
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
            
            if (tab === 'scan') {
                openBodyScan();
            }
        }

        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = '';
            stopCamera();
        }

        // Body Scan Functions
        function openBodyScan() {
            openModal('body-scan-modal');
            initCamera('body-video');
        }

        function openFaceScan() {
            openModal('face-scan-modal');
            initCamera('face-video');
        }

        async function initCamera(videoId) {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment' } 
                });
                const video = document.getElementById(videoId);
                video.srcObject = stream;
                currentStream = stream;
            } catch (err) {
                showNotification('No se pudo acceder a la c√°mara', 'error');
            }
        }

        function stopCamera() {
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
                currentStream = null;
            }
        }

        function switchCamera() {
            // Toggle between front and back camera
            stopCamera();
            // Re-initialize with opposite facing mode
        }

        function toggleFlash() {
            showNotification('Flash no disponible en este dispositivo');
        }

        function captureBodyScan() {
            const video = document.getElementById('body-video');
            const canvas = document.getElementById('body-canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0);
            
            // Simulate processing
            showNotification('Procesando escaneo...');
            
            setTimeout(() => {
                document.getElementById('body-camera').style.display = 'none';
                document.querySelector('.camera-controls').style.display = 'none';
                document.getElementById('body-results').style.display = 'block';
                showNotification('¬°Escaneo completado!');
            }, 2000);
        }

        function saveBodyScan() {
            showNotification('Escaneo guardado en historial');
            closeModal('body-scan-modal');
        }

        // Face Scan
        function captureFaceScan() {
            showNotification('Analizando rasgos faciales...');
            setTimeout(() => {
                document.getElementById('face-results').style.display = 'block';
                showNotification('An√°lisis completado');
            }, 1500);
        }

        // Nutrition Functions
        function openNutrition() {
            openModal('nutrition-modal');
        }

        function openFoodCamera() {
            openModal('food-camera-modal');
            initCamera('food-video');
        }

        function captureFood() {
            showNotification('Analizando alimentos con IA...');
            setTimeout(() => {
                document.getElementById('food-analysis').style.display = 'block';
            }, 2000);
        }

        function confirmFoodLog() {
            showNotification('Alimentos registrados');
            closeModal('food-camera-modal');
            closeModal('nutrition-modal');
        }

        function retakeFood() {
            document.getElementById('food-analysis').style.display = 'none';
        }

        function addFood(meal) {
            const foodName = prompt('Nombre del alimento:');
            if (foodName) {
                const calories = Math.floor(Math.random() * 300) + 100;
                const container = document.getElementById(meal + '-items');
                const item = document.createElement('div');
                item.className = 'food-item';
                item.innerHTML = `
                    <div class="food-info">
                        <h4>${foodName}</h4>
                        <p>Porci√≥n est√°ndar</p>
                    </div>
                    <div class="food-calories">${calories} kcal</div>
                `;
                container.appendChild(item);
                showNotification('Alimento agregado');
            }
        }

        function generateRecipe() {
            const messages = [
                "Receta generada: Bowl de quinoa con pollo y aguacate (550 kcal)",
                "Receta generada: Wrap de at√∫n con espinacas (380 kcal)",
                "Receta generada: Batido proteico de frutos rojos (320 kcal)"
            ];
            showNotification(messages[Math.floor(Math.random() * messages.length)]);
        }

        function emotionalEatingCheck() {
            const mood = prompt('¬øC√≥mo te sientes ahora? (Estresado, Aburrido, Feliz, Ansioso)');
            if (mood) {
                showNotification(`Check-in registrado: ${mood}. ${mood === 'Feliz' ? '¬°Excelente!' : 'Toma agua y espera 10 minutos antes de comer'}`);
            }
        }

        function generateShoppingList() {
            showNotification('Lista de compras generada y exportada');
        }

        // Workout Functions
        function openWorkout() {
            openModal('workout-modal');
        }

        function filterExercises(muscle) {
            showNotification(`Mostrando ejercicios de ${muscle}`);
        }

        function showExerciseDetail(id) {
            showNotification('Cargando detalles del ejercicio...');
        }

        function generateRoutineWithAI() {
            const goal = document.getElementById('routine-goal').value;
            const days = document.getElementById('routine-days').value;
            
            if (!goal || !days) {
                showNotification('Completa todos los campos', 'error');
                return;
            }
            
            showNotification('Generando rutina personalizada con IA...');
            setTimeout(() => {
                showNotification('¬°Rutina generada! Revisa tu pesta√±a de entrenamientos');
                closeModal('workout-modal');
            }, 2000);
        }

        function startWorkout() {
            workoutActive = true;
            openModal('active-workout-modal');
            if (voiceCoachEnabled) {
                speak('Comenzando press de banca. Cuatro series de ocho repeticiones con ochenta kilos');
            }
        }

        function pauseWorkout() {
            if (confirm('¬øPausar entrenamiento?')) {
                closeModal('active-workout-modal');
                workoutActive = false;
            }
        }

        function toggleVoiceCoach() {
            voiceCoachEnabled = !voiceCoachEnabled;
            const btn = document.getElementById('voice-btn');
            btn.style.color = voiceCoachEnabled ? 'var(--accent-primary)' : '';
            
            if (voiceCoachEnabled) {
                document.getElementById('voice-indicator').classList.add('active');
                speak('Entrenador por voz activado');
            } else {
                document.getElementById('voice-indicator').classList.remove('active');
            }
        }

        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'es-ES';
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
            }
        }

        function adjustWeight(amount) {
            const display = document.getElementById('weight-display');
            let current = parseFloat(display.textContent);
            current += amount;
            display.textContent = current;
        }

        function adjustReps(amount) {
            const display = document.getElementById('reps-display');
            let current = parseInt(display.textContent);
            current += amount;
            if (current < 0) current = 0;
            display.textContent = current;
        }

        function completeSet() {
            if (voiceCoachEnabled) {
                speak('Serie completada. Descanso de noventa segundos.');
            }
            startRestTimer();
            showNotification('¬°Serie completada! Iniciando descanso');
        }

        // Timer Functions
        function startRestTimer() {
            if (restTimerInterval) clearInterval(restTimerInterval);
            
            const btn = document.getElementById('timer-btn');
            btn.innerHTML = '<i class="fas fa-pause"></i>';
            btn.classList.remove('start');
            btn.classList.add('pause');
            btn.onclick = pauseRestTimer;
            
            restTimerInterval = setInterval(() => {
                restTimeRemaining--;
                updateTimerDisplay();
                
                if (restTimeRemaining <= 0) {
                    clearInterval(restTimerInterval);
                    if (voiceCoachEnabled) {
                        speak('Descanso terminado. Prepara la siguiente serie.');
                    }
                    showNotification('¬°Descanso terminado!');
                    resetRestTimer();
                }
            }, 1000);
        }

        function pauseRestTimer() {
            clearInterval(restTimerInterval);
            const btn = document.getElementById('timer-btn');
            btn.innerHTML = '<i class="fas fa-play"></i>';
            btn.classList.remove('pause');
            btn.classList.add('start');
            btn.onclick = startRestTimer;
        }

        function resetRestTimer() {
            clearInterval(restTimerInterval);
            restTimeRemaining = 90;
            updateTimerDisplay();
            const btn = document.getElementById('timer-btn');
            btn.innerHTML = '<i class="fas fa-play"></i>';
            btn.classList.remove('pause');
            btn.classList.add('start');
            btn.onclick = startRestTimer;
        }

        function updateTimerDisplay() {
            const mins = Math.floor(restTimeRemaining / 60);
            const secs = restTimeRemaining % 60;
            document.getElementById('rest-timer').textContent = 
                `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function open1RMCalculator() {
            const weight = prompt('Peso levantado (kg):');
            const reps = prompt('Repeticiones:');
            if (weight && reps) {
                const rm = (weight * reps * 0.0333) + parseFloat(weight);
                showNotification(`Tu 1RM estimado es: ${rm.toFixed(1)} kg`);
            }
        }

        function openVolumeCalculator() {
            showNotification('Calculadora de volumen abierta');
        }

        // Steps Functions
        function openSteps() {
            openModal('steps-modal');
        }

        function initStepCounter() {
            if ('Accelerometer' in window) {
                try {
                    const accelerometer = new Accelerometer({ frequency: 10 });
                    accelerometer.addEventListener('reading', () => {
                        // Simple step detection algorithm would go here
                    });
                    accelerometer.start();
                } catch (e) {
                    // Fallback to device motion
                    window.addEventListener('devicemotion', handleMotion);
                }
            } else {
                window.addEventListener('devicemotion', handleMotion);
            }
            
            // Simulate step updates
            setInterval(() => {
                if (Math.random() > 0.7) {
                    stepCount += Math.floor(Math.random() * 5);
                    document.getElementById('steps-count').textContent = stepCount.toLocaleString();
                    document.getElementById('steps-main').textContent = stepCount.toLocaleString();
                }
            }, 3000);
        }

        function handleMotion(event) {
            // Step detection algorithm using accelerometer data
            const acc = event.accelerationIncludingGravity;
            if (!acc) return;
            
            const magnitude = Math.sqrt(acc.x**2 + acc.y**2 + acc.z**2);
            // Threshold detection for steps would be implemented here
        }

        function startGPSActivity() {
            if ('geolocation' in navigator) {
                showNotification('Iniciando seguimiento GPS...');
                navigator.geolocation.watchPosition(
                    (position) => {
                        console.log('GPS:', position.coords);
                    },
                    (err) => {
                        showNotification('Error de GPS: ' + err.message, 'error');
                    },
                    { enableHighAccuracy: true }
                );
            } else {
                showNotification('GPS no disponible en este dispositivo', 'error');
            }
        }

        // Style Functions
        function openStyle() {
            openModal('style-modal');
            initCamera('style-video');
        }

        function selectHairstyle(id) {
            document.querySelectorAll('.hairstyle-thumb').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.hairstyle-thumb')[id].classList.add('active');
            showNotification('Aplicando filtro de peinado...');
        }

        function showHairstyleDetail(id) {
            showNotification('Cargando detalles del corte...');
        }

        // History Functions
        function openHistory() {
            openModal('history-modal');
        }

        function filterHistory(type) {
            showNotification(`Filtrando por: ${type}`);
        }

        function exportData() {
            const data = {
                exportDate: new Date().toISOString(),
                user: 'Usuario Vitalis',
                scans: 12,
                workouts: 45,
                meals: 180
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'vitalis-data.json';
            a.click();
            
            showNotification('Datos exportados correctamente');
        }

        // AI Chat Functions
        function openAIChat() {
            openModal('ai-chat-modal');
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;
            
            addChatMessage(message, 'user');
            input.value = '';
            
            // Simulate AI response
            setTimeout(() => {
                const responses = [
                    "Basado en tu progreso, te recomiendo aumentar el peso en press de banca un 5% la pr√≥xima semana.",
                    "Para tu objetivo de definici√≥n, mant√©n los carbohidratos alrededor de 180g en d√≠as de entreno.",
                    "He analizado tu t√©cnica y sugiero enfocarte en el recorrido completo en las aperturas.",
                    "Tu consistencia es del 87%. ¬°Sigue as√≠ para alcanzar tu meta en 3 semanas!"
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                addChatMessage(response, 'ai');
            }, 1000);
        }

        function addChatMessage(text, sender) {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            div.style.cssText = 'display: flex; gap: 10px; margin-bottom: 15px;';
            
            if (sender === 'user') {
                div.style.flexDirection = 'row-reverse';
                div.innerHTML = `
                    <div style="width: 35px; height: 35px; border-radius: 50%; background: var(--accent-primary); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <i class="fas fa-user" style="font-size: 14px;"></i>
                    </div>
                    <div style="background: var(--accent-primary); color: var(--bg-primary); padding: 12px 15px; border-radius: 15px; border-bottom-right-radius: 5px; max-width: 80%; font-size: 14px;">
                        ${text}
                    </div>
                `;
            } else {
                div.innerHTML = `
                    <div style="width: 35px; height: 35px; border-radius: 50%; background: var(--gradient-1); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                        <i class="fas fa-robot" style="font-size: 14px;"></i>
                    </div>
                    <div style="background: var(--bg-card); padding: 12px 15px; border-radius: 15px; border-bottom-left-radius: 5px; max-width: 80%; font-size: 14px;">
                        ${text}
                    </div>
                `;
            }
            
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        function quickAsk(question) {
            document.getElementById('chat-input').value = question;
            sendMessage();
        }

        // Quick Actions
        function quickLogWeight() {
            const weight = prompt('Introduce tu peso actual (kg):');
            if (weight) {
                showNotification(`Peso registrado: ${weight} kg`);
            }
        }

        function quickAddWater() {
            showNotification('¬°+250ml de agua registrados! üíß');
        }

        function quickStartWorkout() {
            openWorkout();
        }

        function quickScanFood() {
            openNutrition();
            setTimeout(() => openFoodCamera(), 300);
        }

        // Utility Functions
        function showNotification(message, type = 'success') {
            const notif = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            
            text.textContent = message;
            notif.className = 'notification ' + type + ' show';
            
            setTimeout(() => {
                notif.classList.remove('show');
            }, 3000);
        }

        function openProfile() {
            showNotification('Perfil de usuario (pr√≥ximamente)');
        }

        // Service Worker Registration for PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(() => {
                console.log('Service Worker registered');
            });
        }
    </script>
</body>
</html>
